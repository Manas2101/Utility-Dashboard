<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Automation Utilities Dashboard</title>

  <link rel="icon" type="image/png" href="/{{ app_name }}/static/mcphub.png" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />

  <style>

    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

    * {box-sizing:border-box;}

    body {font-family: 'Inter', 'Segoe UI', Arial, sans-serif; margin:0; background:#0a0e27; color:#fff; min-height:100vh; position:relative; overflow-x:hidden;}

    body::before {content:''; position:fixed; top:0; left:0; right:0; bottom:0; background:radial-gradient(circle at 20% 50%, rgba(219,0,17,0.15) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0,135,90,0.1) 0%, transparent 50%); pointer-events:none; z-index:0;}

  .container {max-width:1500px;margin:0 auto;padding:40px 32px;position:relative;z-index:1;}

  h1 {font-size:48px;display:flex;align-items:center;justify-content:center;gap:16px;margin:0 0 12px;color:#fff;font-weight:800;letter-spacing:-1px;text-shadow:0 2px 20px rgba(219,0,17,0.3);}

    h1 .icon {color:#DB0011; filter:drop-shadow(0 0 20px rgba(219,0,17,0.6));}

  .subtitle {font-size:16px;color:rgba(255,255,255,0.7);margin:0 0 60px;text-align:center;font-weight:500;}

  .categories-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(380px,1fr));gap:28px;margin:40px 0;}

  .category-card {background:rgba(255,255,255,0.03);backdrop-filter:blur(20px);border-radius:24px;padding:32px;box-shadow:0 8px 32px rgba(0,0,0,.3), inset 0 1px 0 rgba(255,255,255,0.1);transition:all .4s cubic-bezier(0.4, 0, 0.2, 1);border:1px solid rgba(255,255,255,0.08);position:relative;overflow:hidden;}

  .category-card::before {content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg, #DB0011, #FF4444);opacity:0;transition:opacity .4s;}

  .category-card:hover::before {opacity:1;}

  .category-card:hover {transform:translateY(-8px) scale(1.02);box-shadow:0 20px 60px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,0.15);border-color:rgba(219,0,17,0.3);}

  .category-card.expandable {cursor:pointer;}

  .category-card.expanded {grid-column:1/-1;}

  .category-header {display:flex;align-items:center;gap:16px;margin-bottom:20px;}

  .category-icon {width:56px;height:56px;background:linear-gradient(135deg,#DB0011,#FF4444);border-radius:16px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:28px;box-shadow:0 8px 24px rgba(219,0,17,0.4);}

  .category-title {font-size:24px;font-weight:700;color:#fff;margin:0;display:flex;align-items:center;gap:12px;}

  .expand-indicator {font-size:18px;color:rgba(255,255,255,0.5);transition:transform .3s;}

  .category-card.expanded .expand-indicator {transform:rotate(180deg);}

  .category-description {font-size:14px;color:rgba(255,255,255,0.6);margin:0 0 24px;line-height:1.6;}

  .utilities-grid {display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px;max-height:0;overflow:hidden;opacity:0;transition:all .5s cubic-bezier(0.4, 0, 0.2, 1);}

  .category-card.expanded .utilities-grid {max-height:2000px;opacity:1;margin-top:24px;}

  .utility-mini-card {background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:20px;transition:all .3s;text-decoration:none;color:#fff;display:block;}

  .utility-mini-card:hover {background:rgba(255,255,255,0.08);border-color:rgba(219,0,17,0.5);transform:translateX(8px);box-shadow:0 4px 20px rgba(219,0,17,0.2);}

  .utility-mini-title {font-size:16px;font-weight:600;margin:0 0 8px;display:flex;align-items:center;gap:10px;}

  .utility-mini-desc {font-size:13px;color:rgba(255,255,255,0.5);margin:0;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}

  .utility-status-badge {font-size:10px;padding:4px 8px;border-radius:8px;text-transform:uppercase;font-weight:700;letter-spacing:0.5px;}

  .status-running {background:rgba(0,135,90,0.2);color:#00FF88;border:1px solid rgba(0,255,136,0.3);}

  .status-implementing {background:rgba(255,165,0,0.2);color:#FFB84D;border:1px solid rgba(255,184,77,0.3);}

  .subcategory-list {display:flex;flex-direction:column;gap:12px;}

  .subcategory-item {background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:14px;padding:16px 18px;display:flex;align-items:center;justify-content:space-between;transition:all .3s;cursor:pointer;text-decoration:none;color:#fff;}

  .subcategory-item:hover {background:rgba(255,255,255,0.08);border-color:rgba(219,0,17,0.5);transform:translateX(6px);}

  .subcategory-item.disabled {opacity:0.4;cursor:not-allowed;}

  .subcategory-item.disabled:hover {transform:none;border-color:rgba(255,255,255,0.1);}

  .subcategory-name {font-size:15px;font-weight:600;display:flex;align-items:center;gap:10px;}

  .subcategory-badge {font-size:10px;padding:4px 10px;border-radius:12px;text-transform:uppercase;letter-spacing:.6px;font-weight:700;}

  .badge-coming-soon {background:rgba(255,165,0,0.2);color:#FFB84D;border:1px solid rgba(255,184,77,0.3);}

  .badge-tbd {background:rgba(128,128,128,0.2);color:#999;border:1px solid rgba(153,153,153,0.3);}

  .subcategory-arrow {color:#DB0011;font-size:18px;}

  .utilities-section {margin-top:80px;display:none;}

  .section-header {display:flex;align-items:center;justify-content:space-between;margin-bottom:32px;}

  .section-title {font-size:32px;font-weight:700;color:#fff;margin:0;}

  .filter-bar {display:flex;gap:12px;flex-wrap:wrap;margin:20px 0 26px;}

    .filter-bar input {flex:1;min-width:260px;padding:14px 18px;border:1px solid rgba(255,255,255,0.1);border-radius:12px;font-size:14px;background:rgba(255,255,255,0.05);color:#fff;}

    .filter-bar input::placeholder {color:rgba(255,255,255,0.4);}

    .filter-bar input:focus {outline:none;border-color:#DB0011;background:rgba(255,255,255,0.08);box-shadow:0 0 0 3px rgba(219,0,17,0.1);}

    .filter-bar button {background:linear-gradient(135deg,#DB0011,#FF4444);color:#fff;border:none;padding:14px 24px;border-radius:12px;cursor:pointer;font-weight:600;transition:all .3s;box-shadow:0 4px 16px rgba(219,0,17,0.3);}

    .filter-bar button:hover {transform:translateY(-2px);box-shadow:0 6px 24px rgba(219,0,17,0.5);}

  .stats {margin:20px 0 30px;font-size:15px;color:rgba(255,255,255,0.6);text-align:center;}

  .stats strong {font-size:24px;font-weight:700;color:#fff;background:linear-gradient(135deg,#DB0011,#FF4444);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}

    .grid {display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px;}

    .card {background:rgba(255,255,255,0.03);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:20px;display:flex;flex-direction:column;position:relative;box-shadow:0 4px 20px rgba(0,0,0,.2);transition:all .3s;}    

    .card:hover {transform:translateY(-4px);box-shadow:0 8px 32px rgba(0,0,0,.4);border-color:rgba(219,0,17,0.3);}

    .card.running {border-left:4px solid #00FF88;}

    .card.available {border-left:4px solid #4D9FFF;}

    .card.implementing {border-left:4px solid #FFB84D;}

    .card .title-row {display:flex;align-items:center;gap:10px;margin-bottom:8px;}

    .card img.icon {width:40px;height:40px;object-fit:contain;border-radius:6px;background:#fff;border:1px solid #eee;}

    .card h2 {font-size:17px;margin:0;flex:1;line-height:1.3;color:#fff;font-weight:600;}

    .desc {font-size:13px;line-height:1.5;color:rgba(255,255,255,0.6);margin:0 0 12px;max-height:72px;overflow:hidden;position:relative;}

    .meta {display:flex;flex-wrap:wrap;gap:6px;margin-bottom:10px;}

    .badge {font-size:11px;padding:4px 6px;border-radius:4px;background:#f0f0f0;color:#333;}

    .actions {display:flex;justify-content:space-between;align-items:center;margin-top:auto;}

    .like {cursor:pointer;display:flex;align-items:center;gap:4px;font-size:12px;color:#DB0011;}

    .like .count {font-weight:600;}

    .status-pill {position:absolute;top:8px;right:8px;font-size:11px;padding:4px 8px;border-radius:20px;text-transform:uppercase;letter-spacing:.5px;background:#666;color:#fff;}

    .card.running .status-pill {background:#00875A;}

    .card.available .status-pill {background:#1e90ff;}

  .card-divider {border:none;border-top:1px solid #eee;margin:10px 0 8px;}

  .code-link {display:inline-flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:6px;background:#f0f0f0;color:#333;text-decoration:none;font-size:14px;}

  .code-link:hover {background:#e2e2e2;color:#000;}

  .title-link {color:#141414;text-decoration:none;}

  .title-link:hover {text-decoration:underline;}

  .action-icons {display:flex;align-items:center;gap:6px;}

  .icon-btn {display:inline-flex;width:30px;height:30px;align-items:center;justify-content:center;background:#f0f0f0;border-radius:6px;color:#333;text-decoration:none;font-size:14px;}

  .icon-btn:hover {background:#e2e2e2;color:#000;}

  .like {transition:color .15s ease;}

  .like i {color:#bbb;}

  .like:hover i {color:#888;}

  .actions {display:flex;justify-content:space-between;align-items:center;gap:12px;}

  .left-group, .right-group {display:flex;align-items:center;gap:6px;}

  .right-group .like {display:inline-flex;align-items:center;gap:4px;cursor:pointer;padding:4px 10px;border:none;border-radius:18px;background:#f3f3f3;font-size:12px;}

  .right-group .like.liked {background:#ffe6e8;}

  .right-group .like.liked i {color:#DB0011;}

  .right-group .like .count {font-weight:600;font-size:12px;}

  .right-group .comment-btn {width:auto;height:auto;padding:4px 10px;border:none;border-radius:18px;background:#f3f3f3;display:inline-flex;align-items:center;justify-content:center;color:#444;cursor:pointer;}

  .right-group .comment-btn:hover {background:#e7e7e7;}

  .right-group .comment-btn:active {background:#ddd;}

  .right-group .like:hover {background:#e7e7e7;}

  .like.liked i {color:#DB0011;}

  .like.liked .count {color:#DB0011;}

  .comments-panel {margin-top:10px;border:1px solid #eee;padding:10px;border-radius:8px;background:#fafafa;}

  .comments-panel .comments-list {max-height:140px;overflow:auto;margin-bottom:8px;display:flex;flex-direction:column;gap:6px;}

  .comment-item {background:#fff;border:1px solid #e5e5e5;padding:6px 8px;border-radius:6px;font-size:12px;display:flex;justify-content:space-between;gap:10px;}

  .comment-item time {font-size:10px;color:#777;white-space:nowrap;}

  .comment-form {display:flex;gap:6px;}

  .comment-form input {flex:1;padding:6px 8px;font-size:12px;border:1px solid #ccc;border-radius:4px;}

  .comment-form button {padding:6px 10px;font-size:12px;background:#DB0011;color:#fff;border:none;border-radius:4px;cursor:pointer;}

  .comment-form button:hover {background:#b9000e;}

  .no-comments {font-size:12px;color:#666;}

  .card .line {font-size:12px; margin:2px 0 4px; display:flex; flex-wrap:wrap; gap:4px; align-items:center;}

  .card .label-key {font-weight:600; color:#222;}

  .card .label-val.status {padding:2px 6px; border-radius:12px; background:#ececec; font-size:11px; text-transform:capitalize;}

  .card.running .label-val.status {background:#e0f6ef; color:#006b47;}

  .card.implementing .label-val.status, .card.implementation .label-val.status {background:#e8e7e5; color:red;}

  .card .label-val.developer {font-weight:500;}

  .card .label-val.source {font-style:italic; color:#555;}

    footer {margin:80px 0 20px;text-align:center;font-size:13px;color:rgba(255,255,255,0.3);font-weight:500;}

    .no-results {grid-column:1/-1;text-align:center;padding:40px 0;color:#666;}

     .head-class {

        color: var(--hsbc-black);

        font-size: 28px;

        font-weight: 600;

        margin: 0 0 10px;

        letter-spacing: 0.5px;

        display: flex;

        align-items: center;

        justify-content: center; /* horizontally center icon + text */

        gap: 10px;

        text-align: center; /* ensures multiline center if wraps */

        width: 100%;

      }

  .page-header {position:relative;text-align:center;}

  .add-utility-btn {position:absolute;top:0;left:0;display:inline-flex;align-items:center;gap:10px;padding:14px 24px;background:linear-gradient(135deg,#00FF88,#00CC6F);color:#0a0e27;text-decoration:none;border-radius:14px;font-weight:700;font-size:15px;box-shadow:0 8px 24px rgba(0,255,136,0.3);transition:all .3s;border:1px solid rgba(255,255,255,0.2);}

  .add-utility-btn:hover {transform:translateY(-3px);box-shadow:0 12px 32px rgba(0,255,136,0.5);background:linear-gradient(135deg,#00FFAA,#00DD7F);}

  .add-utility-btn i {font-size:16px;}

  .header-menu {position:absolute;top:0;right:0;}

  .menu-trigger {width:52px;height:52px;display:flex;align-items:center;justify-content:center;border-radius:16px;background:linear-gradient(135deg,#DB0011,#FF4444);cursor:pointer;color:#fff;font-size:22px;font-weight:600;box-shadow:0 8px 24px rgba(219,0,17,0.4);transition:.3s all;border:1px solid rgba(255,255,255,0.1);}

  .menu-trigger:hover {transform:translateY(-2px);box-shadow:0 12px 32px rgba(219,0,17,0.6);}

  .menu-trigger:active {transform:scale(.94);}

  .menu-panel {position:absolute;top:64px;right:0;background:rgba(20,24,48,0.95);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,0.1);box-shadow:0 20px 60px rgba(0,0,0,.5);border-radius:20px;padding:24px;display:none;z-index:70;min-width:280px;}

  .menu-panel.visible {display:block;animation:fadeScale .18s ease;}

  @keyframes fadeScale {0%{opacity:0;transform:translateY(-6px) scale(.96);}100%{opacity:1;transform:translateY(0) scale(1);}}

  .menu-grid {display:grid;grid-template-columns:repeat(2,1fr);gap:14px;}

  .menu-item {background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:18px 12px 14px;display:flex;flex-direction:column;align-items:center;justify-content:center;text-decoration:none;position:relative;isolation:isolate;cursor:pointer;transition:.3s all;color:#fff;font-size:13px;font-weight:600;line-height:1.2;text-align:center;min-height:100px;}

  .menu-item i {font-size:26px;margin-bottom:8px;color:#DB0011;transition:color .18s;}

  .menu-item:hover {background:rgba(219,0,17,0.1);border-color:rgba(219,0,17,0.5);box-shadow:0 8px 24px rgba(219,0,17,.2);transform:translateY(-4px);}

  .menu-item:active {transform:translateY(0);}

  .menu-item span {display:block;font-size:12px;font-weight:600;letter-spacing:.4px;}

  .menu-item.add i {color:#DB0011;}

  .menu-item.guide i {color:#DB0011;}

  .menu-item.refresh i {color:#DB0011;}

  .menu-item.home i {color:#DB0011;}

  .menu-meta {margin-top:14px;display:flex;justify-content:space-between;font-size:11px;color:#777;padding:0 2px;}

  .menu-meta span {display:inline-flex;align-items:center;gap:4px;}

  .menu-meta i {font-size:12px;color:#999;}

  .menu-close-tip {position:absolute;top:8px;left:16px;font-size:10px;color:#aaa;text-transform:uppercase;letter-spacing:.6px;font-weight:600;}

  .menu-accessibility-hint {position:absolute;top:8px;right:16px;font-size:10px;color:#aaa;letter-spacing:.6px;font-weight:600;}

  .menu-panel:focus-visible {outline:2px solid #DB0011;outline-offset:4px;}

  .menu-item:focus-visible {outline:2px solid #DB0011;outline-offset:2px;}

  </style>

</head>

<body>

  <div class="container">

    <div class="page-header">

      <h1 class="head-class"><i class="fas fa-cogs icon"></i>DATAP Automation Utilities Dashboard</h1>

      <p class="subtitle">Centralized hub for automation utilities, release management, and DevOps metrics</p>

      <a href="/{{ app_name }}/add" class="add-utility-btn" title="Add New Utility">

        <i class="fas fa-plus"></i>

        <span>Add Utility</span>

      </a>

      <div class="header-menu" id="headerMenu">

        <div class="menu-trigger" id="menuTrigger" title="Quick actions" aria-haspopup="true" aria-expanded="false" aria-controls="menuPanel">

          <i class="fa fa-grip"></i>

        </div>

        <div class="menu-panel" id="menuPanel" role="menu" aria-hidden="true" aria-label="Automation utilities quick actions">

          <div class="menu-grid" role="group" aria-label="Primary actions">

            <button type="button" class="menu-item add" data-action="add" title="Add Utility" aria-label="Add Utility">

              <i class="fa fa-plus"></i>

              <span>Add</span>

            </button>

            <button type="button" class="menu-item guide" data-action="guide" title="Guide (placeholder)" aria-label="Guide">

              <i class="fa fa-book"></i>

              <span>Guide</span>

            </button>

            <button type="button" class="menu-item refresh" data-action="refresh" title="Refresh Data" aria-label="Refresh Data">

              <i class="fa fa-rotate"></i>

              <span>Refresh</span>

            </button>

            <a href="/{{ app_name }}/home.html" class="menu-item home" title="Dashboard" aria-label="Dashboard" data-action="home">

              <i class="fa fa-home"></i>

              <span>Home</span>

            </a>

          </div>

          <div class="menu-meta">

            <span><i class="fa fa-lightbulb"></i>v0.1</span>

            <span><i class="fa fa-keyboard"></i>Esc to close</span>

          </div>

        </div>

      </div>

    </div>

    <div class="categories-grid">

      <div class="category-card expandable" id="datapUtilitiesCard">

        <div class="category-header">

          <div class="category-icon"><i class="fas fa-tools"></i></div>

          <h2 class="category-title">DATAP Utilities <span class="expand-indicator"><i class="fas fa-chevron-down"></i></span></h2>

        </div>

        <p class="category-description">Click to explore all automation utilities in the DATAP ecosystem</p>

        <div class="utilities-grid" id="utilitiesGrid">

          <div style="text-align:center;padding:40px;color:rgba(255,255,255,0.5);font-size:14px;grid-column:1/-1;">Loading utilities...</div>

        </div>

      </div>

      <div class="category-card">

        <div class="category-header">

          <div class="category-icon" style="background:linear-gradient(135deg,#4D9FFF,#0066CC);"><i class="fas fa-calendar-alt"></i></div>

          <h2 class="category-title">CDMS Release Manager</h2>

        </div>

        <p class="category-description">Manage releases, track schedules, and generate release documentation</p>

        <div class="subcategory-list" id="releaseManagerList">

          <div style="text-align:center;padding:20px;color:rgba(255,255,255,0.5);font-size:13px;">Loading...</div>

        </div>

      </div>

      <div class="category-card">

        <div class="category-header">

          <div class="category-icon" style="background:linear-gradient(135deg,#FFB84D,#FF8C00);"><i class="fas fa-chart-line"></i></div>

          <h2 class="category-title">DevOps Metrics</h2>

        </div>

        <p class="category-description">Track and analyze DevOps performance metrics and KPIs</p>

        <div class="subcategory-list">

          <a href="#" class="subcategory-item" onclick="alert('LTTD - Coming Soon'); return false;">

            <span class="subcategory-name"><i class="fas fa-clock"></i> LTTD</span>

            <span class="subcategory-arrow"><i class="fas fa-arrow-right"></i></span>

          </a>

          <div class="subcategory-item disabled">

            <span class="subcategory-name"><i class="fas fa-robot"></i> RF <span class="subcategory-badge badge-coming-soon">Coming Soon</span></span>

          </div>

        </div>

      </div>

      <div class="category-card">

        <div class="category-header">

          <div class="category-icon" style="background:linear-gradient(135deg,#9B59B6,#8E44AD);"><i class="fas fa-brain"></i></div>

          <h2 class="category-title">Agentic DevOps</h2>

        </div>

        <p class="category-description">AI-powered DevOps automation and intelligent workflow orchestration</p>

        <div class="subcategory-list">

          <div class="subcategory-item disabled">

            <span class="subcategory-name"><i class="fas fa-magic"></i> AI Workflow Builder <span class="subcategory-badge badge-coming-soon">Coming Soon</span></span>

          </div>

          <div class="subcategory-item disabled">

            <span class="subcategory-name"><i class="fas fa-robot"></i> Intelligent Agents <span class="subcategory-badge badge-coming-soon">Coming Soon</span></span>

          </div>

          <div class="subcategory-item disabled">

            <span class="subcategory-name"><i class="fas fa-network-wired"></i> Auto-Orchestration <span class="subcategory-badge badge-coming-soon">Coming Soon</span></span>

          </div>

        </div>

      </div>

      <div class="category-card">

        <div class="category-header">

          <div class="category-icon" style="background:linear-gradient(135deg,#E74C3C,#C0392B);"><i class="fas fa-exclamation-triangle"></i></div>

          <h2 class="category-title">DATAP Overdue Tasks</h2>

        </div>

        <p class="category-description">Monitor and manage overdue tasks across DATAP projects</p>

        <div class="subcategory-list">

          <div class="subcategory-item disabled">

            <span class="subcategory-name"><i class="fas fa-list-check"></i> Task Dashboard <span class="subcategory-badge badge-tbd">TBD</span></span>

          </div>

          <div class="subcategory-item disabled">

            <span class="subcategory-name"><i class="fas fa-bell"></i> Alert System <span class="subcategory-badge badge-tbd">TBD</span></span>

          </div>

          <div class="subcategory-item disabled">

            <span class="subcategory-name"><i class="fas fa-chart-bar"></i> Analytics <span class="subcategory-badge badge-tbd">TBD</span></span>

          </div>

        </div>

      </div>

    </div>

    <div class="utilities-section">

      <div class="section-header">

        <h2 class="section-title">All Utilities</h2>

      </div>

      <div class="filter-bar">

        <input id="searchInput" placeholder="Search utilities by title, type, developer, description..." />

        <button id="btnRunning">Running (0)</button>

        <button id="btnAll" class="all active">Show All</button>

      </div>

      <div class="stats">

        <strong id="totalUtilities">0</strong> automation utilities integrate with <strong id="totalTools">0</strong> tools.

      </div>

      <div id="grid" class="grid">

        <p id="loading">Loading utilities...</p>

      </div>

    </div>

  </div>

  <footer>UI-only prototype â€¢ Data is Static for now</footer>

  <script src="/{{ app_name }}/static/utilities.js"></script>

  <script>

    // Wait for DOM to be fully loaded

    document.addEventListener('DOMContentLoaded', function() {

      console.log('DOM loaded, initializing utilities dashboard...');

      

      // Expandable DATAP Utilities card functionality

      let allUtilities = [];

      const datapCard = document.getElementById('datapUtilitiesCard');

      const utilitiesGrid = document.getElementById('utilitiesGrid');

      

      console.log('Elements found:', {datapCard: !!datapCard, utilitiesGrid: !!utilitiesGrid});

      

      // Toggle expand/collapse

      if (datapCard) {

        datapCard.addEventListener('click', (e) => {

          // Don't toggle if clicking on a utility card link

          if (e.target.tagName === 'A' || e.target.closest('a.utility-mini-card')) {

            return;

          }

          e.preventDefault();

          console.log('Toggling DATAP Utilities card');

          datapCard.classList.toggle('expanded');

        });

      } else {

        console.error('datapCard element not found!');

      }

      

      // Load and populate utilities

      (async function(){

      try {

        const response = await fetch('/{{ app_name }}/api/utilities');

        console.log('API Response status:', response.status);

        

        if (response.ok) {

          allUtilities = await response.json();

          console.log('Utilities loaded:', allUtilities.length, allUtilities);

          

          if (!utilitiesGrid) {

            console.error('utilitiesGrid element not found!');

            return;

          }

          

          if (allUtilities && allUtilities.length > 0) {

            utilitiesGrid.innerHTML = '';

            

            allUtilities.forEach(util => {

              const card = document.createElement('a');

              card.href = `/{{ app_name }}/utility/${util.id}`;

              card.className = 'utility-mini-card';

              

              const statusClass = util.status ? `status-${util.status.toLowerCase()}` : '';

              const statusBadge = util.status ? `<span class="utility-status-badge ${statusClass}">${util.status}</span>` : '';

              

              card.innerHTML = `

                <div class="utility-mini-title">

                  <i class="fas fa-plug" style="color:#DB0011;"></i>

                  <span style="flex:1;">${util.title}</span>

                  ${statusBadge}

                </div>

                <div class="utility-mini-desc">${util.description || 'No description available'}</div>

              `;

              

              utilitiesGrid.appendChild(card);

            });

          } else {

            utilitiesGrid.innerHTML = `<div style="text-align:center;padding:40px;color:rgba(255,255,255,0.5);font-size:14px;grid-column:1/-1;">

              <i class="fas fa-inbox" style="font-size:48px;margin-bottom:16px;opacity:0.3;"></i><br>

              No utilities found. <a href="/{{ app_name }}/add" style="color:#00FF88;text-decoration:underline;">Add your first utility</a>

            </div>`;

          }

        } else {

          console.error('API returned error:', response.status);

          utilitiesGrid.innerHTML = `<div style="text-align:center;padding:40px;color:rgba(255,100,100,0.7);font-size:14px;grid-column:1/-1;">

            <i class="fas fa-exclamation-circle" style="font-size:32px;margin-bottom:12px;"></i><br>

            Failed to load utilities (Status: ${response.status})

          </div>`;

        }

      } catch (e) {

        console.error('Failed to load utilities:', e);

        if (utilitiesGrid) {

          utilitiesGrid.innerHTML = `<div style="text-align:center;padding:40px;color:rgba(255,100,100,0.7);font-size:14px;grid-column:1/-1;">

            <i class="fas fa-exclamation-circle" style="font-size:32px;margin-bottom:12px;"></i><br>

            Failed to load utilities: ${e.message}<br>

            <small style="opacity:0.6;">Check console for details</small>

          </div>`;

        }

      }

    })();



    // Populate CDMS Release Manager from utilities with category='release_manager'

    (async function(){

      console.log('Loading CDMS Release Manager utilities...');

      try {

        const response = await fetch('/{{ app_name }}/api/utilities');

        console.log('CDMS API Response status:', response.status);

        

        if (response.ok) {

          const utilities = await response.json();

          console.log('Total utilities for CDMS filter:', utilities.length);

          

          const releaseManagerUtils = utilities.filter(u => 

            u.type && (u.type.toLowerCase().includes('release') || u.type.toLowerCase().includes('cdms'))

          );

          

          console.log('Filtered release manager utilities:', releaseManagerUtils.length, releaseManagerUtils);

          

          const releaseManagerList = document.getElementById('releaseManagerList');

          

          if (!releaseManagerList) {

            console.error('releaseManagerList element not found!');

            return;

          }

          

          if (releaseManagerUtils.length > 0) {

            releaseManagerList.innerHTML = '';

            releaseManagerUtils.forEach(util => {

              const item = document.createElement('a');

              item.href = `/{{ app_name }}/utility/${util.id}`;

              item.className = 'subcategory-item';

              item.innerHTML = `

                <span class="subcategory-name"><i class="fas fa-calendar-check"></i> ${util.title}</span>

                <span class="subcategory-arrow"><i class="fas fa-arrow-right"></i></span>

              `;

              releaseManagerList.appendChild(item);

            });

          } else {

            console.log('No release manager utilities found');

            releaseManagerList.innerHTML = '<div style="text-align:center;padding:20px;color:rgba(255,255,255,0.4);font-size:13px;"><i class="fas fa-info-circle"></i> No release utilities yet</div>';

          }

        } else {

          console.error('CDMS API returned error:', response.status);

          const releaseManagerList = document.getElementById('releaseManagerList');

          if (releaseManagerList) {

            releaseManagerList.innerHTML = '<div style="text-align:center;padding:20px;color:rgba(255,100,100,0.6);font-size:13px;"><i class="fas fa-exclamation-circle"></i> Failed to load</div>';

          }

        }

      } catch (e) {

        console.error('Failed to load release manager utilities:', e);

        const releaseManagerList = document.getElementById('releaseManagerList');

        if (releaseManagerList) {

          releaseManagerList.innerHTML = '<div style="text-align:center;padding:20px;color:rgba(255,100,100,0.6);font-size:13px;"><i class="fas fa-exclamation-circle"></i> Error loading</div>';

        }

      }

    })();

    

    // Menu functionality

    (function(){

      const trigger = document.getElementById('menuTrigger');

      const panel = document.getElementById('menuPanel');

      if(!trigger || !panel) return;

      function openPanel(){

        panel.classList.add('visible');

        panel.setAttribute('aria-hidden','false');

        trigger.setAttribute('aria-expanded','true');

      }

      function closePanel(){

        panel.classList.remove('visible');

        panel.setAttribute('aria-hidden','true');

        trigger.setAttribute('aria-expanded','false');

      }

      trigger.addEventListener('click', ()=>{

        if(panel.classList.contains('visible')) closePanel(); else openPanel();

      });

      document.addEventListener('click', e=>{

        if(!panel.contains(e.target) && !trigger.contains(e.target)) closePanel();

      });

      document.addEventListener('keydown', e=>{

        if(e.key==='Escape') closePanel();

        if(e.key==='ArrowDown' && document.activeElement===trigger){

          openPanel();

          const first = panel.querySelector('.menu-item');

          if(first) first.focus();

        }

        if(e.key==='Tab' && panel.classList.contains('visible')){

          // keep focus inside

          const focusables = Array.from(panel.querySelectorAll('.menu-item'));

          if(!focusables.length) return;

          const first = focusables[0];

          const last = focusables[focusables.length-1];

          if(e.shiftKey && document.activeElement===first){ e.preventDefault(); last.focus(); }

          else if(!e.shiftKey && document.activeElement===last){ e.preventDefault(); first.focus(); }

        }

      });

      panel.addEventListener('click', e=>{

        const el = e.target.closest('[data-action]');

        if(!el) return;

        const action = el.getAttribute('data-action');

        if(action==='refresh'){ window.location.reload(); }

  else if(action==='guide'){ alert('Guide page not yet implemented.'); }

  else if(action==='add'){ window.location.href='/{{ app_name }}/add'; return; }

        else if(action==='home'){ closePanel(); }

        closePanel();

      });

    })();

    

    }); // End DOMContentLoaded

  </script>

</body>

</html>